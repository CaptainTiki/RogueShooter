extends Panel
class_name GunBenchStatsPanel

@export var gun_bench : GunBench

@onready var fire_mode_label: Label = $GridContainer/FireMode_label
@onready var dmg_label: Label = $GridContainer/Dmg_label
@onready var fire_rate_label: Label = $GridContainer/FireRate_label
@onready var mag_size_label: Label = $GridContainer/MagSize_label
@onready var reload_time_label: Label = $GridContainer/ReloadTime_label
@onready var accuracy_label: Label = $GridContainer/Accuracy_label
@onready var recoil_label: Label = $GridContainer/Recoil_label
@onready var dps_label: Label = $GridContainer/DPS_label

var gunstats : GunStats = GunStats.new()

func _ready() -> void:
	gun_bench.BuildChanged.connect(on_build_changed)

func on_build_changed(build : GunBuild) -> void:
	gunstats = GunCalc.calculate_stats(build)
	update_UI()

func update_UI() -> void:
	fire_mode_label.text = str(GunPartDef.FireMode.keys()[gunstats.fire_mode])
	dmg_label.text = str(gunstats.damage)
	fire_rate_label.text = str(gunstats.fire_rate)
	mag_size_label.text = str(gunstats.mag_size)
	reload_time_label.text = str(gunstats.reload_time)
	accuracy_label.text = str(gunstats.spread)
	recoil_label.text = str(gunstats.recoil)
	dps_label.text = str(gunstats.dps)
